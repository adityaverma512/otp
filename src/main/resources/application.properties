############################################
# Application Basic Settings
############################################
spring.application.name=otp-service
spring.redis.host=localhost
spring.redis.port=6379
server.port=8080

############################################
# OTP Configuration
############################################
otp.length=6
otp.expirySeconds=180

# Resend Settings
otp.resend.cooldownSeconds=30
otp.resend.generateNewOtp=true

# Security Settings
otp.security.hashAlgorithm=SHA-256
otp.security.useHashing=true

# System Settings
otp.origSystem=appexp
otp.defaultLocale=US

############################################
# Validation Settings
############################################
validation.email.pattern=^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$
validation.email.maxLength=254

validation.phone.pattern=^[+]?[0-9]{10,15}$
validation.phone.minLength=10
validation.phone.maxLength=15

validation.otp.pattern=^[0-9]{6}$
validation.otp.length=6

validation.name.pattern=^[A-Za-z ]{1,100}$
validation.name.maxLength=100

############################################
# Circuit Breaker Configuration (SIMPLIFIED)
############################################
# Circuit opens after 50% failure rate
# Sliding window of 10 calls
# Minimum 5 calls before evaluation
# Wait 30 seconds in OPEN state before trying HALF_OPEN
# Allow 3 test calls in HALF_OPEN state

resilience4j.circuitbreaker.instances.salesforceClient.registerHealthIndicator=true
resilience4j.circuitbreaker.instances.salesforceClient.slidingWindowSize=10
resilience4j.circuitbreaker.instances.salesforceClient.minimumNumberOfCalls=5
resilience4j.circuitbreaker.instances.salesforceClient.permittedNumberOfCallsInHalfOpenState=3
resilience4j.circuitbreaker.instances.salesforceClient.automaticTransitionFromOpenToHalfOpenEnabled=true
resilience4j.circuitbreaker.instances.salesforceClient.waitDurationInOpenState=30s
resilience4j.circuitbreaker.instances.salesforceClient.failureRateThreshold=50

# Record these exceptions as failures
resilience4j.circuitbreaker.instances.salesforceClient.recordExceptions[0]=java.util.concurrent.TimeoutException
resilience4j.circuitbreaker.instances.salesforceClient.recordExceptions[1]=java.net.ConnectException
resilience4j.circuitbreaker.instances.salesforceClient.recordExceptions[2]=com.example.otp.exception.SalesforceServiceException

# Ignore these exceptions (don't count as failures)
resilience4j.circuitbreaker.instances.salesforceClient.ignoreExceptions[0]=com.example.otp.exception.ValidationException

############################################
# Salesforce Simulation
# Set failure-rate to 0.6 (60%) to test circuit breaker
############################################
salesforce.simulation.enabled=true
salesforce.simulation.failure-rate=0.0
salesforce.simulation.delay-ms=1000
salesforce.simulation.timeout-ms=3000

salesforce.api.endpoint=https://api.salesforce.com/otp/send
salesforce.api.timeout=5000

############################################
# Azure Service Bus Simulation
############################################
azure.servicebus.simulation.enabled=true
azure.servicebus.simulation.queue-name=otp-notification-queue
azure.servicebus.connection-string=Endpoint=sb://...
azure.servicebus.queue-name=otp-notifications